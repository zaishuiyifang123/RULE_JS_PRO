{
  "session_id": "908e2f7c33b145eb",
  "admin_id": 1,
  "step_name": "sql_generation",
  "status": "success",
  "error_message": null,
  "timestamp": "2026-02-11T16:11:33",
  "input": {
    "rewritten_query": "分析22级计算机科学与技术专业一班的成绩趋势",
    "parse_result": {
      "intent": "business_query",
      "entities": [
        {
          "type": "grade",
          "value": "22级"
        },
        {
          "type": "major",
          "value": "计算机科学与技术"
        },
        {
          "type": "class",
          "value": "一班"
        }
      ],
      "dimensions": [
        "score.term"
      ],
      "metrics": [
        "avg(score.score_value)"
      ],
      "filters": [
        {
          "field": "class.grade_year",
          "op": "=",
          "value": 2022
        },
        {
          "field": "major.major_name",
          "op": "=",
          "value": "计算机科学与技术"
        },
        {
          "field": "class.class_name",
          "op": "=",
          "value": "一班"
        },
        {
          "field": "student.class_id",
          "op": "=",
          "value": "class.id"
        },
        {
          "field": "student.major_id",
          "op": "=",
          "value": "major.id"
        },
        {
          "field": "score.student_id",
          "op": "=",
          "value": "student.id"
        }
      ],
      "time_range": {
        "start": null,
        "end": null
      },
      "operation": "trend",
      "confidence": 0.95
    },
    "hidden_context_result": {
      "error_type": "execution_error",
      "error": "",
      "failed_sql": "WITH base AS (SELECT score.term, score.score_value FROM student JOIN class ON student.class_id = class.id JOIN major ON student.major_id = major.id JOIN score ON student.id = score.student_id WHERE class.grade_year = 2022 AND major.major_name = '计算机科学与技术' AND class.class_name = '一班' AND student.is_deleted = 0 AND class.is_deleted = 0 AND major.is_deleted = 0 AND score.is_deleted = 0) SELECT base.term, AVG(base.score_value) AS avg_score_value FROM base GROUP BY base.term ORDER BY base.term",
      "rewritten_query": "分析22级计算机科学与技术专业一班的成绩趋势",
      "field_candidates": [],
      "probe_samples": [
        {
          "field": "score.term",
          "probe_sql": "SELECT DISTINCT score.term AS value FROM score WHERE score.term IS NOT NULL AND score.is_deleted = 0 LIMIT 20",
          "values": [
            "2025-2026-1"
          ]
        },
        {
          "field": "score.score_value",
          "probe_sql": "SELECT DISTINCT score.score_value AS value FROM score WHERE score.score_value IS NOT NULL AND score.is_deleted = 0 LIMIT 20",
          "values": [
            "59.8",
            "90.7",
            "87.1",
            "99.5",
            "66.5",
            "61.6",
            "95.5",
            "99.1",
            "66.0",
            "51.2",
            "98.6",
            "85.9",
            "90.8",
            "78.2",
            "63.1",
            "94.5",
            "62.5",
            "60.9",
            "92.0",
            "57.3"
          ]
        },
        {
          "field": "student.class_id",
          "probe_sql": "SELECT DISTINCT student.class_id AS value FROM student WHERE student.class_id IS NOT NULL AND student.is_deleted = 0 LIMIT 20",
          "values": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20"
          ]
        },
        {
          "field": "class.id",
          "probe_sql": "SELECT DISTINCT class.id AS value FROM class WHERE class.id IS NOT NULL AND class.is_deleted = 0",
          "values": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20",
            "21",
            "22",
            "23",
            "24",
            "25",
            "26",
            "27",
            "28",
            "29",
            "30",
            "31",
            "32",
            "33",
            "34",
            "35",
            "36",
            "37",
            "38",
            "39",
            "40",
            "41",
            "42",
            "43",
            "44",
            "45",
            "46",
            "47",
            "48",
            "49",
            "50",
            "51",
            "52",
            "53",
            "54",
            "55",
            "56",
            "57",
            "58",
            "59",
            "60",
            "61",
            "62",
            "63",
            "64",
            "65",
            "66",
            "67",
            "68",
            "69",
            "70",
            "71",
            "72",
            "73",
            "74",
            "75",
            "76",
            "77",
            "78",
            "79",
            "80",
            "81",
            "82",
            "83",
            "84",
            "85",
            "86",
            "87",
            "88",
            "89",
            "90",
            "91",
            "92",
            "93",
            "94",
            "95",
            "96",
            "97",
            "98",
            "99",
            "100",
            "101",
            "102",
            "103",
            "104",
            "105",
            "106",
            "107",
            "108",
            "109",
            "110",
            "111",
            "112",
            "113",
            "114",
            "115",
            "116",
            "117",
            "118",
            "119",
            "120",
            "121",
            "122",
            "123",
            "124",
            "125",
            "126",
            "127",
            "128",
            "129",
            "130",
            "131",
            "132",
            "133",
            "134",
            "135",
            "136",
            "137",
            "138",
            "139",
            "140",
            "141",
            "142",
            "143",
            "144",
            "145",
            "146",
            "147",
            "148",
            "149",
            "150",
            "151",
            "152",
            "153",
            "154",
            "155",
            "156",
            "157",
            "158",
            "159",
            "160",
            "161",
            "162",
            "163",
            "164",
            "165",
            "166",
            "167",
            "168",
            "169",
            "170",
            "171",
            "172",
            "173",
            "174",
            "175",
            "176",
            "177",
            "178",
            "179",
            "180",
            "181",
            "182",
            "183",
            "184",
            "185",
            "186",
            "187",
            "188",
            "189",
            "190",
            "191",
            "192",
            "193",
            "194",
            "195",
            "196",
            "197",
            "198",
            "199",
            "200",
            "201",
            "202",
            "203",
            "204",
            "205",
            "206",
            "207",
            "208",
            "209",
            "210",
            "211",
            "212",
            "213",
            "214",
            "215",
            "216",
            "217",
            "218",
            "219",
            "220",
            "221",
            "222",
            "223",
            "224",
            "225",
            "226",
            "227",
            "228",
            "229",
            "230",
            "231",
            "232",
            "233",
            "234",
            "235",
            "236",
            "237",
            "238",
            "239",
            "240",
            "241",
            "242",
            "243",
            "244",
            "245",
            "246",
            "247",
            "248",
            "249",
            "250",
            "251",
            "252",
            "253",
            "254",
            "255",
            "256",
            "257",
            "258",
            "259",
            "260",
            "261",
            "262",
            "263",
            "264",
            "265",
            "266",
            "267",
            "268",
            "269",
            "270",
            "271",
            "272",
            "273",
            "274",
            "275",
            "276",
            "277",
            "278",
            "279",
            "280",
            "281",
            "282",
            "283",
            "284",
            "285",
            "286",
            "287",
            "288",
            "289",
            "290",
            "291",
            "292",
            "293",
            "294",
            "295",
            "296",
            "297",
            "298",
            "299",
            "300",
            "301",
            "302",
            "303",
            "304",
            "305",
            "306",
            "307",
            "308",
            "309",
            "310",
            "311",
            "312",
            "313",
            "314",
            "315",
            "316",
            "317",
            "318",
            "319",
            "320",
            "321",
            "322",
            "323",
            "324",
            "325",
            "326",
            "327",
            "328",
            "329",
            "330",
            "331",
            "332",
            "333",
            "334",
            "335",
            "336",
            "337",
            "338",
            "339",
            "340",
            "341",
            "342",
            "343",
            "344",
            "345",
            "346",
            "347",
            "348",
            "349",
            "350",
            "351",
            "352",
            "353",
            "354",
            "355",
            "356",
            "357",
            "358",
            "359",
            "360",
            "361",
            "362",
            "363",
            "364",
            "365",
            "366",
            "367",
            "368",
            "369",
            "370",
            "371",
            "372",
            "373",
            "374",
            "375",
            "376",
            "377",
            "378",
            "379",
            "380",
            "381",
            "382",
            "383",
            "384"
          ]
        },
        {
          "field": "student.major_id",
          "probe_sql": "SELECT DISTINCT student.major_id AS value FROM student WHERE student.major_id IS NOT NULL AND student.is_deleted = 0 LIMIT 20",
          "values": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20"
          ]
        },
        {
          "field": "major.id",
          "probe_sql": "SELECT DISTINCT major.id AS value FROM major WHERE major.id IS NOT NULL AND major.is_deleted = 0 LIMIT 20",
          "values": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20"
          ]
        },
        {
          "field": "student.id",
          "probe_sql": "SELECT DISTINCT student.id AS value FROM student WHERE student.id IS NOT NULL AND student.is_deleted = 0 LIMIT 20",
          "values": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20"
          ]
        },
        {
          "field": "score.student_id",
          "probe_sql": "SELECT DISTINCT score.student_id AS value FROM score WHERE score.student_id IS NOT NULL AND score.is_deleted = 0 LIMIT 20",
          "values": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20"
          ]
        },
        {
          "field": "class.grade_year",
          "probe_sql": "SELECT DISTINCT class.grade_year AS value FROM class WHERE class.grade_year IS NOT NULL AND class.is_deleted = 0",
          "values": [
            "2022",
            "2024",
            "2023",
            "2025"
          ]
        },
        {
          "field": "major.major_name",
          "probe_sql": "SELECT DISTINCT major.major_name AS value FROM major WHERE major.major_name IS NOT NULL AND major.is_deleted = 0 LIMIT 20",
          "values": [
            "计算机科学与技术",
            "软件工程",
            "人工智能",
            "数据科学与大数据技术",
            "网络工程",
            "信息安全",
            "自动化",
            "机械设计制造及其自动化",
            "电气工程及其自动化",
            "土木工程",
            "财务管理",
            "市场营销",
            "人力资源管理",
            "工商管理",
            "会计学",
            "汉语言文学",
            "新闻传播学",
            "英语",
            "日语",
            "数学与应用数学"
          ]
        },
        {
          "field": "class.class_name",
          "probe_sql": "SELECT DISTINCT class.class_name AS value FROM class WHERE class.class_name IS NOT NULL AND class.is_deleted = 0",
          "values": [
            "2022级计算机科学与技术1班",
            "2022级计算机科学与技术2班",
            "2024级计算机科学与技术3班",
            "2023级计算机科学与技术4班",
            "2023级计算机科学与技术5班",
            "2023级计算机科学与技术6班",
            "2022级软件工程1班",
            "2022级软件工程2班",
            "2025级软件工程3班",
            "2022级软件工程4班",
            "2022级软件工程5班",
            "2022级软件工程6班",
            "2023级人工智能1班",
            "2023级人工智能2班",
            "2022级人工智能3班",
            "2023级人工智能4班",
            "2025级人工智能5班",
            "2023级人工智能6班",
            "2025级数据科学与大数据技术1班",
            "2024级数据科学与大数据技术2班",
            "2022级数据科学与大数据技术3班",
            "2023级数据科学与大数据技术4班",
            "2025级数据科学与大数据技术5班",
            "2024级数据科学与大数据技术6班",
            "2024级网络工程1班",
            "2023级网络工程2班",
            "2023级网络工程3班",
            "2024级网络工程4班",
            "2022级网络工程5班",
            "2022级网络工程6班",
            "2025级信息安全1班",
            "2022级信息安全2班",
            "2024级信息安全3班",
            "2024级信息安全4班",
            "2024级信息安全5班",
            "2022级信息安全6班",
            "2025级自动化1班",
            "2022级自动化2班",
            "2025级自动化3班",
            "2022级自动化4班",
            "2024级自动化5班",
            "2024级自动化6班",
            "2023级机械设计制造及其自动化1班",
            "2022级机械设计制造及其自动化2班",
            "2022级机械设计制造及其自动化3班",
            "2023级机械设计制造及其自动化4班",
            "2024级机械设计制造及其自动化5班",
            "2022级机械设计制造及其自动化6班",
            "2023级电气工程及其自动化1班",
            "2022级电气工程及其自动化2班",
            "2025级电气工程及其自动化3班",
            "2024级电气工程及其自动化4班",
            "2025级电气工程及其自动化5班",
            "2024级电气工程及其自动化6班",
            "2023级土木工程1班",
            "2024级土木工程2班",
            "2024级土木工程3班",
            "2023级土木工程4班",
            "2024级土木工程5班",
            "2022级土木工程6班",
            "2023级财务管理1班",
            "2023级财务管理2班",
            "2023级财务管理3班",
            "2025级财务管理4班",
            "2025级财务管理5班",
            "2024级财务管理6班",
            "2023级市场营销1班",
            "2024级市场营销2班",
            "2022级市场营销3班",
            "2023级市场营销4班",
            "2022级市场营销5班",
            "2024级市场营销6班",
            "2025级人力资源管理1班",
            "2024级人力资源管理2班",
            "2022级人力资源管理3班",
            "2023级人力资源管理4班",
            "2024级人力资源管理5班",
            "2023级人力资源管理6班",
            "2025级工商管理1班",
            "2025级工商管理2班",
            "2025级工商管理3班",
            "2023级工商管理4班",
            "2024级工商管理5班",
            "2023级工商管理6班",
            "2023级会计学1班",
            "2024级会计学2班",
            "2025级会计学3班",
            "2025级会计学4班",
            "2024级会计学5班",
            "2023级会计学6班",
            "2023级汉语言文学1班",
            "2025级汉语言文学2班",
            "2022级汉语言文学3班",
            "2022级汉语言文学4班",
            "2022级汉语言文学5班",
            "2023级汉语言文学6班",
            "2023级新闻传播学1班",
            "2025级新闻传播学2班",
            "2022级新闻传播学3班",
            "2025级新闻传播学4班",
            "2025级新闻传播学5班",
            "2025级新闻传播学6班",
            "2024级英语1班",
            "2022级英语2班",
            "2022级英语3班",
            "2024级英语4班",
            "2024级英语5班",
            "2022级英语6班",
            "2024级日语1班",
            "2025级日语2班",
            "2023级日语3班",
            "2025级日语4班",
            "2022级日语5班",
            "2024级日语6班",
            "2023级数学与应用数学1班",
            "2022级数学与应用数学2班",
            "2024级数学与应用数学3班",
            "2023级数学与应用数学4班",
            "2023级数学与应用数学5班",
            "2024级数学与应用数学6班",
            "2023级物理学1班",
            "2022级物理学2班",
            "2024级物理学3班",
            "2025级物理学4班",
            "2022级物理学5班",
            "2022级物理学6班",
            "2024级化学1班",
            "2024级化学2班",
            "2023级化学3班",
            "2022级化学4班",
            "2023级化学5班",
            "2022级化学6班",
            "2022级数字媒体艺术1班",
            "2025级数字媒体艺术2班",
            "2022级数字媒体艺术3班",
            "2023级数字媒体艺术4班",
            "2023级数字媒体艺术5班",
            "2025级数字媒体艺术6班",
            "2023级视觉传达设计1班",
            "2024级视觉传达设计2班",
            "2025级视觉传达设计3班",
            "2023级视觉传达设计4班",
            "2023级视觉传达设计5班",
            "2024级视觉传达设计6班",
            "2025级计算机科学与技术21班",
            "2024级计算机科学与技术22班",
            "2025级计算机科学与技术23班",
            "2025级计算机科学与技术24班",
            "2022级计算机科学与技术25班",
            "2023级计算机科学与技术26班",
            "2023级软件工程21班",
            "2022级软件工程22班",
            "2024级软件工程23班",
            "2022级软件工程24班",
            "2023级软件工程25班",
            "2023级软件工程26班",
            "2022级人工智能21班",
            "2022级人工智能22班",
            "2022级人工智能23班",
            "2023级人工智能24班",
            "2022级人工智能25班",
            "2022级人工智能26班",
            "2024级数据科学与大数据技术21班",
            "2022级数据科学与大数据技术22班",
            "2023级数据科学与大数据技术23班",
            "2024级数据科学与大数据技术24班",
            "2025级数据科学与大数据技术25班",
            "2023级数据科学与大数据技术26班",
            "2023级网络工程21班",
            "2025级网络工程22班",
            "2023级网络工程23班",
            "2025级网络工程24班",
            "2025级网络工程25班",
            "2023级网络工程26班",
            "2022级信息安全21班",
            "2022级信息安全22班",
            "2025级信息安全23班",
            "2024级信息安全24班",
            "2025级信息安全25班",
            "2025级信息安全26班",
            "2025级自动化21班",
            "2022级自动化22班",
            "2022级自动化23班",
            "2022级自动化24班",
            "2025级自动化25班",
            "2024级自动化26班",
            "2022级机械设计制造及其自动化21班",
            "2023级机械设计制造及其自动化22班",
            "2023级机械设计制造及其自动化23班",
            "2023级机械设计制造及其自动化24班",
            "2025级机械设计制造及其自动化25班",
            "2023级机械设计制造及其自动化26班",
            "2025级电气工程及其自动化21班",
            "2023级电气工程及其自动化22班",
            "2024级电气工程及其自动化23班",
            "2025级电气工程及其自动化24班",
            "2023级电气工程及其自动化25班",
            "2022级电气工程及其自动化26班",
            "2025级土木工程21班",
            "2022级土木工程22班",
            "2022级土木工程23班",
            "2022级土木工程24班",
            "2022级土木工程25班",
            "2023级土木工程26班",
            "2023级财务管理21班",
            "2025级财务管理22班",
            "2025级财务管理23班",
            "2025级财务管理24班",
            "2023级财务管理25班",
            "2025级财务管理26班",
            "2022级市场营销21班",
            "2023级市场营销22班",
            "2025级市场营销23班",
            "2022级市场营销24班",
            "2025级市场营销25班",
            "2024级市场营销26班",
            "2025级人力资源管理21班",
            "2024级人力资源管理22班",
            "2025级人力资源管理23班",
            "2025级人力资源管理24班",
            "2023级人力资源管理25班",
            "2023级人力资源管理26班",
            "2024级工商管理21班",
            "2023级工商管理22班",
            "2022级工商管理23班",
            "2022级工商管理24班",
            "2024级工商管理25班",
            "2022级工商管理26班",
            "2022级会计学21班",
            "2025级会计学22班",
            "2023级会计学23班",
            "2022级会计学24班",
            "2022级会计学25班",
            "2023级会计学26班",
            "2022级汉语言文学21班",
            "2022级汉语言文学22班",
            "2023级汉语言文学23班",
            "2025级汉语言文学24班",
            "2022级汉语言文学25班",
            "2023级汉语言文学26班",
            "2022级新闻传播学21班",
            "2022级新闻传播学22班",
            "2025级新闻传播学23班",
            "2024级新闻传播学24班",
            "2024级新闻传播学25班",
            "2023级新闻传播学26班",
            "2024级英语21班",
            "2023级英语22班",
            "2024级英语23班",
            "2025级英语24班",
            "2023级英语25班",
            "2024级英语26班",
            "2025级日语21班",
            "2024级日语22班",
            "2022级日语23班",
            "2022级日语24班",
            "2025级日语25班",
            "2022级日语26班",
            "2022级数学与应用数学21班",
            "2023级数学与应用数学22班",
            "2024级数学与应用数学23班",
            "2023级数学与应用数学24班",
            "2024级数学与应用数学25班",
            "2022级数学与应用数学26班",
            "2023级物理学21班",
            "2024级物理学22班",
            "2024级物理学23班",
            "2023级物理学24班",
            "2025级物理学25班",
            "2024级物理学26班",
            "2022级化学21班",
            "2024级化学22班",
            "2022级化学23班",
            "2023级化学24班",
            "2024级化学25班",
            "2022级化学26班",
            "2022级数字媒体艺术21班",
            "2023级数字媒体艺术22班",
            "2024级数字媒体艺术23班",
            "2024级数字媒体艺术24班",
            "2023级数字媒体艺术25班",
            "2024级数字媒体艺术26班",
            "2023级视觉传达设计21班",
            "2024级视觉传达设计22班",
            "2025级视觉传达设计23班",
            "2024级视觉传达设计24班",
            "2022级视觉传达设计25班",
            "2022级视觉传达设计26班",
            "2025级计算机科学与技术31班",
            "2024级计算机科学与技术32班",
            "2022级计算机科学与技术33班",
            "2022级计算机科学与技术34班",
            "2024级计算机科学与技术35班",
            "2023级计算机科学与技术36班",
            "2024级软件工程31班",
            "2023级软件工程32班",
            "2025级软件工程33班",
            "2025级软件工程34班",
            "2022级软件工程35班",
            "2022级软件工程36班",
            "2022级人工智能31班",
            "2023级人工智能32班",
            "2022级人工智能33班",
            "2024级人工智能34班",
            "2023级人工智能35班",
            "2025级人工智能36班",
            "2023级数据科学与大数据技术31班",
            "2022级数据科学与大数据技术32班",
            "2024级数据科学与大数据技术33班",
            "2024级数据科学与大数据技术34班",
            "2022级数据科学与大数据技术35班",
            "2024级数据科学与大数据技术36班",
            "2023级网络工程31班",
            "2023级网络工程32班",
            "2022级网络工程33班",
            "2024级网络工程34班",
            "2025级网络工程35班",
            "2023级网络工程36班",
            "2023级信息安全31班",
            "2023级信息安全32班",
            "2023级信息安全33班",
            "2025级信息安全34班",
            "2022级信息安全35班",
            "2023级信息安全36班",
            "2024级自动化31班",
            "2025级自动化32班",
            "2023级自动化33班",
            "2024级自动化34班",
            "2023级自动化35班",
            "2022级自动化36班",
            "2025级机械设计制造及其自动化31班",
            "2022级机械设计制造及其自动化32班",
            "2025级机械设计制造及其自动化33班",
            "2023级机械设计制造及其自动化34班",
            "2023级机械设计制造及其自动化35班",
            "2025级机械设计制造及其自动化36班",
            "2024级电气工程及其自动化31班",
            "2024级电气工程及其自动化32班",
            "2023级电气工程及其自动化33班",
            "2023级电气工程及其自动化34班",
            "2022级电气工程及其自动化35班",
            "2023级电气工程及其自动化36班",
            "2025级土木工程31班",
            "2024级土木工程32班",
            "2024级土木工程33班",
            "2022级土木工程34班",
            "2024级土木工程35班",
            "2024级土木工程36班",
            "2025级财务管理31班",
            "2024级财务管理32班",
            "2022级财务管理33班",
            "2022级财务管理34班",
            "2024级财务管理35班",
            "2023级财务管理36班",
            "2024级市场营销31班",
            "2022级市场营销32班",
            "2022级市场营销33班",
            "2025级市场营销34班",
            "2024级市场营销35班",
            "2024级市场营销36班",
            "2025级人力资源管理31班",
            "2022级人力资源管理32班",
            "2025级人力资源管理33班",
            "2023级人力资源管理34班",
            "2024级人力资源管理35班",
            "2022级人力资源管理36班",
            "2025级工商管理31班",
            "2022级工商管理32班",
            "2023级工商管理33班",
            "2024级工商管理34班",
            "2025级工商管理35班",
            "2022级工商管理36班",
            "2024级会计学31班",
            "2024级会计学32班",
            "2022级会计学33班",
            "2024级会计学34班",
            "2024级会计学35班",
            "2025级会计学36班",
            "2024级汉语言文学31班",
            "2025级汉语言文学32班",
            "2024级汉语言文学33班",
            "2023级汉语言文学34班",
            "2023级汉语言文学35班",
            "2025级汉语言文学36班"
          ]
        },
        {
          "field": "student.is_deleted",
          "probe_sql": "SELECT DISTINCT student.is_deleted AS value FROM student WHERE student.is_deleted IS NOT NULL AND student.is_deleted = 0 LIMIT 20",
          "values": [
            "0"
          ]
        },
        {
          "field": "class.is_deleted",
          "probe_sql": "SELECT DISTINCT class.is_deleted AS value FROM class WHERE class.is_deleted IS NOT NULL AND class.is_deleted = 0",
          "values": [
            "0"
          ]
        },
        {
          "field": "major.is_deleted",
          "probe_sql": "SELECT DISTINCT major.is_deleted AS value FROM major WHERE major.is_deleted IS NOT NULL AND major.is_deleted = 0 LIMIT 20",
          "values": [
            "0"
          ]
        },
        {
          "field": "score.is_deleted",
          "probe_sql": "SELECT DISTINCT score.is_deleted AS value FROM score WHERE score.is_deleted IS NOT NULL AND score.is_deleted = 0 LIMIT 20",
          "values": [
            "0"
          ]
        }
      ],
      "hints": [
        "error_type=execution_error",
        "use_probe_samples_to_rewrite_filters_or_entities",
        "retry_sql_generation_with_hidden_context"
      ],
      "kb_summary": {
        "table_count": 10,
        "field_count": 84
      },
      "retry_count": 1
    }
  },
  "output": {
    "sql": "WITH base AS (SELECT score.term, score.score_value FROM student JOIN class ON student.class_id = class.id JOIN major ON student.major_id = major.id JOIN score ON student.id = score.student_id WHERE class.grade_year = 2022 AND major.major_name = '计算机科学与技术' AND class.class_name LIKE '2022级计算机科学与技术1班' AND student.is_deleted = 0 AND class.is_deleted = 0 AND major.is_deleted = 0 AND score.is_deleted = 0) SELECT base.term, AVG(base.score_value) AS avg_score_value FROM base GROUP BY base.term ORDER BY base.term",
    "entity_mappings": [
      {
        "type": "grade",
        "value": "22级",
        "field": "class.grade_year",
        "reason": "根据字段描述“年级/入学年份（如 2022 级）”及 probe_samples 中 class.grade_year 值为 [2022, 2024, 2023, 2025]，归一化为整数 2022"
      },
      {
        "type": "major",
        "value": "计算机科学与技术",
        "field": "major.major_name",
        "reason": "probe_samples 中 major.major_name 明确包含 '计算机科学与技术'，精确匹配"
      },
      {
        "type": "class",
        "value": "一班",
        "field": "class.class_name",
        "reason": "probe_samples 中 class.class_name 包含 '2022级计算机科学与技术1班'，'一班'对应数字 '1班'，采用 LIKE 模糊匹配确保覆盖可能的前缀（如年份+专业+序号）"
      }
    ],
    "sql_fields": [
      "score.term",
      "score.score_value",
      "student.class_id",
      "class.id",
      "student.major_id",
      "major.id",
      "student.id",
      "score.student_id",
      "class.grade_year",
      "major.major_name",
      "class.class_name",
      "student.is_deleted",
      "class.is_deleted",
      "major.is_deleted",
      "score.is_deleted",
      "base.term",
      "base.score_value"
    ]
  }
}