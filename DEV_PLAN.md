# 教务驾驶舱系统 DEV_PLAN

> 版本规划遵循 1.0 / 2.0 / 3.0 分阶段推进。1.0 为最小可行版本（MVP），仅覆盖“数据底座 + 最小驾驶舱视图”。

---

## 版本 1.0（MVP）

### TASK001 管理员认证与基础框架
- 版本：1.0
- 状态：计划中
- 子任务：
  - 创建后端基础目录结构
  - 初始化 FastAPI 应用
  - 创建管理员表与基础模型
  - 登录/登出接口
  - JWT 认证中间件
- AI 编程助手提示词：
  "你是一个严谨的后端工程助手。请为 FastAPI 项目创建基础结构，包含 main.py、routers、models、schemas、services、config 模块。实现管理员登录/登出接口，使用 JWT 认证。确保密码采用安全哈希算法，接口具备输入校验与错误处理，并使用 MySQL 8.0.25。输出完成后，给出目录树与关键代码说明。"
- 验收标准：
  - 能成功启动 FastAPI
  - 管理员登录成功返回 token
  - 无 token 访问受保护接口会返回 401
- 注意事项：
  - 密码必须使用哈希存储，不得明文
  - 统一错误响应格式

### TASK002 数据库初始化与基础表
- 版本：1.0
- 状态：计划中
- 子任务：
  - 建立 MySQL 连接层
  - 创建基础表（admin、college、major、class、student、teacher、course）
  - 设计 ORM 或 SQL schema
  - 增加审计字段
- AI 编程助手提示词：
  "你是数据库与后端助手。请基于 MySQL 8.0.25 创建教务驾驶舱系统的核心表结构，字段使用下划线命名，包含审计字段。提供建表 SQL 及说明，并在 FastAPI 中建立数据库连接层。"
- 验收标准：
  - 所有基础表可创建
  - 能执行简单查询
- 注意事项：
  - 字段描述需保持一致性
  - 合理设置索引

### TASK003 基础 CRUD 接口
- 版本：1.0
- 状态：计划中
- 子任务：
  - 为基础表生成 CRUD 接口
  - 支持分页与条件过滤
  - 错误统一处理
- AI 编程助手提示词：
  "你是 API 开发助手。请为教务驾驶舱系统基础表实现 CRUD 接口，提供分页与条件筛选能力，使用统一响应格式。要求安全校验与输入验证。"
- 验收标准：
  - CRUD 接口可用
  - 分页可用
- 注意事项：
  - 过滤条件避免 SQL 注入

### TASK004 批量导入功能
- 版本：1.0
- 状态：计划中
- 子任务：
  - CSV/Excel 导入接口
  - 数据校验与错误返回
  - 导入日志记录
- AI 编程助手提示词：
  "你是数据导入助手。请实现教务驾驶舱系统批量导入功能，支持 CSV/Excel，导入时需要字段校验与错误报告，失败行需返回具体原因。"
- 验收标准：
  - 可成功导入学生/教师/课程数据
  - 导入错误可回显
- 注意事项：
  - 导入过程需事务支持

### TASK005 前端基础界面
- 版本：1.0
- 状态：计划中
- 子任务：
  - Vue3 + Vite 初始化
  - 登录页
  - 数据管理页
  - 基础路由与权限校验
- AI 编程助手提示词：
  "你是前端助手。请用 Vue3 + Vite 搭建基础项目，包含登录页与数据管理页，完成路由权限控制。要求页面布局清晰，支持响应式。"
- 验收标准：
  - 可正常访问登录页
  - 登录后进入数据管理页
- 注意事项：
  - 前后端接口需对齐

### TASK006 最小驾驶舱视图
- 版本：1.0
- 状态：计划中
- 子任务：
  - 指标定义表与快照表（最小集）
  - 驾驶舱总览接口
  - 首页视图：指标卡片 + 趋势折线 + 预警列表
- AI 编程助手提示词：
  "你是教务驾驶舱助手。请实现最小驾驶舱视图，包含核心指标卡片、趋势折线与预警列表。提供指标定义与快照数据结构，以及驾驶舱总览接口。"
- 验收标准：
  - 驾驶舱首页可展示核心指标与趋势
  - 预警列表能显示阈值异常
- 注意事项：
  - 指标口径需文档化
  - 预警规则可先固定阈值

---

## 版本 2.0（智能流程）

### TASK007 多 Agents 工作流框架
- 版本：2.0
- 状态：计划中
- 子任务：
  - 接入 LangGraph
  - 定义工作流节点
  - 规范节点输入输出
- AI 编程助手提示词：
  "你是 AI 工作流助手。请使用 LangGraph 构建教务驾驶舱系统的多 Agents 工作流，包含意图识别、任务解析、策略评估、字段清单注入、SQL 生成、SQL 验证、可解释性生成、隐藏上下文探索、结果返回、资产沉淀等节点。请给出每个节点输入输出格式定义。"
- 验收标准：
  - 流程可在本地跑通
- 注意事项：
  - 节点间数据结构必须一致

### TASK008 智能聊天接口与 SSE
- 版本：2.0
- 状态：计划中
- 子任务：
  - /api/chat 接口
  - /api/chat/stream SSE
  - 工作流与聊天对接
- AI 编程助手提示词：
  "你是流式接口助手。请为教务驾驶舱系统实现智能聊天接口，支持 SSE 流式输出工作流步骤信息，确保前端可实时显示进度。"
- 验收标准：
  - SSE 可稳定推送每个步骤
  - 前端能显示步骤状态
- 注意事项：
  - SSE 连接需要超时与异常处理

### TASK009 SQL 生成与验证（验证仅执行 SQL）
- 版本：2.0
- 状态：计划中
- 子任务：
  - LLM SQL 生成
  - SQL 执行与验证
  - 错误回传与重试上下文
- AI 编程助手提示词：
  "你是 SQL 智能助手。请实现 LLM 驱动的 SQL 生成与验证机制，其中验证阶段仅执行 SQL 判定是否报错，并记录错误上下文。"
- 验收标准：
  - 错误 SQL 能回滚与提示
- 注意事项：
  - SQL 需要白名单限制

### TASK010 可解释性输出
- 版本：2.0
- 状态：计划中
- 子任务：
  - 字段映射说明
  - 表关联说明
  - 逻辑摘要输出
- AI 编程助手提示词：
  "你是可解释性助手。请为教务驾驶舱系统输出查询可解释信息，包括字段映射、表关联与逻辑摘要，并与工作流结果一起返回。"
- 验收标准：
  - 查询结果包含可解释说明
- 注意事项：
  - 说明需简洁可读

### TASK011 策略引擎与风险分级
- 版本：2.0
- 状态：计划中
- 子任务：
  - 策略配置表
  - 风险分级规则
  - 高风险操作二次确认
- AI 编程助手提示词：
  "你是策略引擎助手。请为教务驾驶舱系统实现策略配置与风险分级机制，支持高风险操作二次确认，并在日志中记录风险等级。"
- 验收标准：
  - 风险分级生效
  - 高风险操作需确认
- 注意事项：
  - 规则需可配置

---

## 版本 3.0（可视化与知识资产）

### TASK012 工作流可视化
- 版本：3.0
- 状态：计划中
- 子任务：
  - 工作流日志结构优化
  - 节点级回放视图
  - 错误定位与提示
- AI 编程助手提示词：
  "你是工作流可视化助手。请实现工作流执行可视化，支持节点级回放、输入输出查看与错误定位。"
- 验收标准：
  - 可回放工作流
  - 节点状态清晰
- 注意事项：
  - 需兼容长会话记录

### TASK013 历史记录与知识资产
- 版本：3.0
- 状态：计划中
- 子任务：
  - 聊天历史存储
  - 查询模板抽取
  - 模板库管理
- AI 编程助手提示词：
  "你是日志与知识资产助手。请实现历史记录保存与查询模板沉淀，支持模板库管理与检索。"
- 验收标准：
  - 可查询历史记录
  - 模板可复用
- 注意事项：
  - 注意存储规模与分页

### TASK014 安全与审计增强
- 版本：3.0
- 状态：计划中
- 子任务：
  - 登录安全策略
  - 操作日志审计
  - 限流与风控
- AI 编程助手提示词：
  "你是安全与审计助手。请为教务驾驶舱系统加入安全增强机制，包括登录失败限制、操作日志审计、API 限流与敏感操作二次确认。"
- 验收标准：
  - 登录失败会触发限制
  - 审计日志可查询
- 注意事项：
  - 不能影响正常使用

---

## 任务编号与状态说明
- 计划中
- 测试单元编写中
- 开发中
- 完成

---

以上为 DEV_PLAN 详细任务安排。
